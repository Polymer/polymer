<!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<script>
(function() {
  'use strict';

  var userShadyDom = window.ShadyDom;

  var ShadyDom = window.ShadyDom = userShadyDom || {};

  if (!ShadyDom.force) {
    ShadyDom.force = (location.search.indexOf('forceShadyDom=true') >= 0);
  }

  ShadyDom.inUse = ShadyDom.force ||  !Element.prototype.attachShadow;

  var p = Element.prototype;
  var matches = p.matches || p.matchesSelector ||
    p.mozMatchesSelector || p.msMatchesSelector ||
    p.oMatchesSelector || p.webkitMatchesSelector;

  ShadyDom.matchesSelector = function matchesSelector(element, selector) {
    return matches.call(element, selector);
  }

  function copyOwnProperty(name, source, target) {
    var pd = Object.getOwnPropertyDescriptor(source, name);
    if (pd) {
      Object.defineProperty(target, name, pd);
    }
  }

  // TODO(sorvell): Polymer also defines this.
  ShadyDom.extend = function extend(target, source) {
    if (target && source) {
      var n$ = Object.getOwnPropertyNames(source);
      for (var i=0, n; (i<n$.length) && (n=n$[i]); i++) {
        copyOwnProperty(n, source, target);
      }
    }
    return target || source;
  };

  ShadyDom.extendAll = function extendAll(obj /* , ... */) {
    var p$ = Array.prototype.slice.call(arguments, 1);
    for (var i=0; i < p$.length; i++) {
      ShadyDom.extend(obj, p$[i]);
    }
    return obj;
  }

})();
</script>
