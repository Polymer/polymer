<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">



  <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../../web-component-tester/browser.js"></script>
  <link rel="import" href="../../polymer.html">
  <script src="/bower_components/test-fixture/test-fixture-mocha.js"></script>
  <link rel="import" href="/bower_components/test-fixture/test-fixture.html">
  <link rel="import" href="/bower_components/iron-test-helpers/iron-test-helpers.html">

  <!-- Step 1: import the element to test -->
  <link rel="import" href="rules-elements.html">

</head>
<body>

  <test-fixture id="externalLibrary">
    <template>
      <external-library name='f'></<external-library>
    </template>
  </test-fixture>
  <test-fixture id="simpleMinMaxRules">
    <template>
      <simple-min-max-rules></<simple-min-max-rules>
    </template>
  </test-fixture>
  <test-fixture id="enumRules">
    <template>
      <enum-rules></<enum-rules>
    </template>
  </test-fixture>
  <test-fixture id="regexRules">
    <template>
      <regex-rules></<regex-rules>
    </template>
  </test-fixture>


    <script>
    (function (arguments) {
      var setInput = function(element, value) {
        element.value = value;
        var e = new Event('input', {
          bubbles: true
        });
        element.dispatchEvent(e);
      };



      describe('simpleMinMaxRules tests', function() {
        var element;
        before(function() {
          element = fixture('simpleMinMaxRules');
        });

        it('Sould only accept valid strings between 3 and 5', function() {
          setInput(element.$.nameInput, 'f');
          expect(element.name).to.equal(undefined)
          setInput(element.$.nameInput, 'foo');
          expect(element.name).to.equal('foo');
          setInput(element.$.nameInput, 'bazz');
          expect(element.name).to.equal('bazz');
          setInput(element.$.nameInput, 'This value is way too long');
          expect(element.name).to.equal('bazz');
        });
      });


      describe('externalLibrary tests', function() {
        var element;
        before(function() {
          element = fixture('externalLibrary');
        });

        it('Sould only accept valid credit cards', function() {
          setInput(element.$.ccInput, 'foo');
          expect(element.cardNumber).to.equal(undefined)
          setInput(element.$.ccInput, '4485408026947698');
          expect(element.cardNumber).to.equal('4485408026947698');
          setInput(element.$.ccInput, 'bar');
          expect(element.cardNumber).to.equal('4485408026947698');
          setInput(element.$.ccInput, '5188617733186948');
          expect(element.cardNumber).to.equal('5188617733186948');
          setInput(element.$.ccInput, '1231231231231231');
          expect(element.cardNumber).to.equal('5188617733186948');
        });
      });

      describe('enumRules tests', function() {
        var element;
        before(function() {
          element = fixture('enumRules');
        });

        it('Sould only accept Debit or credit', function() {
          setInput(element.$.ccTypeInput, 'foo');
          expect(element.cardType).to.equal(undefined)
          setInput(element.$.ccTypeInput, 'Debit');
          expect(element.cardType).to.equal('Debit');
          setInput(element.$.ccTypeInput, 'EBT');
          expect(element.cardType).to.equal('Debit');
          setInput(element.$.ccTypeInput, 'Credit');
          expect(element.cardType).to.equal('Credit');
        });
      });

      describe('regexRules tests', function() {
        var element;
        before(function() {
          element = fixture('regexRules');
        });

        it('Sould only accept a 10 digit number', function() {
          setInput(element.$.phoneNumberInput, 'foo');
          expect(element.phoneNumber).to.equal(undefined)
          setInput(element.$.phoneNumberInput, '1234567890');
          expect(element.phoneNumber).to.equal('1234567890');
          setInput(element.$.phoneNumberInput, '123456789');
          expect(element.phoneNumber).to.equal('1234567890');
          setInput(element.$.phoneNumberInput, 'abc');
          expect(element.phoneNumber).to.equal('1234567890');
        });
      });


      describe('Notification tests', function() {
        var element;
        before(function() {
          element = fixture('regexRules');
        });

        it('Sould only accept a 10 digit number', function() {
          setInput(element.$.phoneNumberInput, 'foo');
          expect(element.$.phoneNumberInput.style['border-color']).to.equal('red');
          setInput(element.$.phoneNumberInput, '1234567890');
          expect(element.$.phoneNumberInput.style['border-color']).to.equal('green');
          setInput(element.$.phoneNumberInput, '123456789');
          expect(element.$.phoneNumberInput.style['border-color']).to.equal('red');
          setInput(element.$.phoneNumberInput, 'abc');
          expect(element.$.phoneNumberInput.style['border-color']).to.equal('red');
          setInput(element.$.phoneNumberInput, '1234567890');
          expect(element.$.phoneNumberInput.style['border-color']).to.equal('green');
        });
      });




    })();
  </script>

</body>
</html>
