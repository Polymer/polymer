<!DOCTYPE html>
<!--
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>URL integration test</title>
  <script src="../../../tools/test/htmltest.js"></script>
  <script src="../../../tools/test/chai/chai.js"></script>
  <script src="../../../webcomponentsjs/webcomponents.js"></script>
  <link rel="import" href="../../polymer.html">
  <link rel="import" href="url-import/url-import.html" id="url-import">
</head>
<body>
  <template>
    <b id="a" href="/1/2"></b>
    <b id="b" href="2/../3/4"></b>
    <b id="c" href="{{ path }}/baz"></b>
    <b id="d" href="#"></b>
    <b id="e" href="?foo"></b>
  </template>
  <script>
  addEventListener('HTMLImportsLoaded', function() {
    function getUrl(template, id, attr) {
      return template.content.querySelector('#' + id).getAttribute(attr);
    }

    var t = document.querySelector('template');
    Polymer.urlResolver.resolveTemplate(t);

    chai.assert.equal(getUrl(t, 'a', 'href'), '/1/2');
    chai.assert.equal(getUrl(t, 'b', 'href'), '3/4');
    chai.assert.equal(getUrl(t, 'c', 'href'), '{{ path }}/baz');
    chai.assert.equal(getUrl(t, 'd', 'href'), '#');
    chai.assert.equal(getUrl(t, 'e', 'href'), '?foo');

    t = document.getElementById('url-import').import.querySelector('template');
    Polymer.urlResolver.resolveTemplate(t);

    chai.assert.equal(getUrl(t, 'a', 'href'), '/1/2');
    chai.assert.equal(getUrl(t, 'b', 'href'), 'url-import/3/4');
    chai.assert.equal(getUrl(t, 'c', 'href'), '{{ path }}/baz');
    chai.assert.equal(getUrl(t, 'd', 'href'), '#');
    chai.assert.equal(getUrl(t, 'e', 'href'), 'url-import/url-import.html?foo');

    done();
  });
  </script>
</body>
</html>
