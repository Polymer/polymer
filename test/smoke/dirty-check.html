<!DOCTYPE html>
<html>
<head>
  <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../polymer.html">
</head>
<body>

<dom-module id="x-host">
  <template>
    <h1>1 + [[foo]] = [[bar]]</h1>
    <x-child id="child" foo="[[foo]]" bar="{{bar}}"></x-child>
  </template>

  <script>
    class XHost extends Polymer.Element {
      static get properties() {
        return {
          obj: {
            observer: 'objChanged',
          },
        };
      }
      objChanged(val, old) {
        console.log('new', val, 'old', old);
      }
      _shouldPropertyChange(prop, val, old) {
        if (this.strict) {
          return val !== old;
        } else if (val instanceof Date) {
          return !(old instanceof Date) || val.getTime() !== old.getTime();
        } else {
          return super._shouldPropertyChange(prop, val, old);
        }
      }
    }
    customElements.define('x-host', XHost);
  </script>
</dom-module>

<x-host id="host"></x-host>

<script>
var obj = {foo: true};
host.obj = obj;
host.obj = obj;
console.log('strict on')
host.strict = true;
host.obj = obj;
console.log('strict off')
host.strict = false;
host.obj = obj;
host.obj = new Date();
host.obj = new Date(host.obj.getTime());
</script>

</body>
</html>
