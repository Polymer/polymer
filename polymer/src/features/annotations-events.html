<link rel="import" href="annotations.html">

<script>

  /*
   * Parses the annotations map created by `annotations` features to support
   * declarative events.
   * 
   * Depends on `annotations` and `events` features.
   * 
   */
  Base.addFeature({

    // instance-time
    
    _setupAnnotatedListeners: function() {
      var map = this._template.map;
      if (map) {
        map.forEach(function(annotation) {
          var events = annotation.events;
          if (events && events.length) {
            var node = this.findAnnotatedNode(this.root, annotation);
            events.forEach(function(e) {
              //console.log('[%s] listening for [%s] on [%s]', e.value, e.name, node.localName);
              this.listen(node, e.name, e.value);
            }, this)
          }
        }, this);
      }
    }

  });

</script>
